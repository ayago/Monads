This is a copy from frankieSardo's work with additional monads